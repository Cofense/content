elasticcommonfields: {}
id: AutoFocus V2 test
version: -1
fromversion: 5.0.0
name: AutoFocus V2 test
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 69108c33-3563-4fad-8a35-d709974e16ac
    type: start
    task:
      elasticcommonfields: {}
      id: 69108c33-3563-4fad-8a35-d709974e16ac
      version: -1
      name: ""
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "9"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "1":
    id: "1"
    taskid: 6626c128-de4c-4f4c-8f49-946e6bf6532e
    type: regular
    task:
      elasticcommonfields: {}
      id: 6626c128-de4c-4f4c-8f49-946e6bf6532e
      version: -1
      name: autofocus-search-samples
      description: 'Search for samples. To view results run autofocus-samples-search-results
        with the returned Af Cookie. Note: The AF Cookie expires 120 seconds after
        the search completes.'
      script: AutoFocus V2|||autofocus-search-samples
      type: regular
      iscommand: true
      brand: AutoFocus V2
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      advanced_query:
        simple: '`{"operator":"all","children":[{"field":"sample.malware","operator":"is","value":1}]}`'
      domain: {}
      file_hash: {}
      first_seen: {}
      ip: {}
      last_updated: {}
      max_results: {}
      order: {}
      query:
        simple: '{"operator":"all","children":[{"field":"sample.malware","operator":"is","value":1},{"field":"sample.tag","operator":"is
          in the list","value":["Unit42.RunOnce"]}]}'
      scope:
        simple: Global
      sort: {}
      url: {}
      wildfire_verdict: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "2":
    id: "2"
    taskid: 1d201391-2ce8-4537-866b-32f5bdb35da1
    type: regular
    task:
      elasticcommonfields: {}
      id: 1d201391-2ce8-4537-866b-32f5bdb35da1
      version: -1
      name: autofocus-search-sessions
      description: 'Search for sessions. To view results run autofocus-sessions-search-results
        with the returned Af Cookie. Note: The AF Cookie expires 120 seconds after
        the search completes.'
      script: AutoFocus V2|||autofocus-search-sessions
      type: regular
      iscommand: true
      brand: AutoFocus V2
    nexttasks:
      '#none#':
      - "4"
    scriptarguments:
      advanced_query:
        simple: '{"operator":"all","children":[{"field":"sample.malware","operator":"is","value":1}]},"scope":"public","size":50,"from":0,"sort":{"create_date":{"order":"desc"}}'
      max_results: {}
      order: {}
      query:
        simple: '{"operator": "all","children": [{"field": "sample.malware","operator":
          "is","value": "1"}]}'
      sort: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "3":
    id: "3"
    taskid: 23e99ea9-76e9-4d26-84f9-5a0fc236dbc6
    type: condition
    task:
      elasticcommonfields: {}
      id: 23e99ea9-76e9-4d26-84f9-5a0fc236dbc6
      version: -1
      name: Verify context
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "22"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SamplesSearch.AFCookie
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SamplesSearch.Status
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1595
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "4":
    id: "4"
    taskid: cc0d0956-1882-4a8b-82a5-0d0902c71c78
    type: condition
    task:
      elasticcommonfields: {}
      id: cc0d0956-1882-4a8b-82a5-0d0902c71c78
      version: -1
      name: Verify context
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "23"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SessionsSearch.AFCookie
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SessionsSearch.Status
            iscontext: true
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1595
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "5":
    id: "5"
    taskid: 88a04b87-d67b-4e6f-8adb-57bb3f5e88ea
    type: regular
    task:
      elasticcommonfields: {}
      id: 88a04b87-d67b-4e6f-8adb-57bb3f5e88ea
      version: -1
      name: autofocus-samples-search-results
      description: Get results of a previous samples search
      script: AutoFocus V2|||autofocus-samples-search-results
      type: regular
      iscommand: true
      brand: AutoFocus V2
    nexttasks:
      '#none#':
      - "7"
    scriptarguments:
      af_cookie:
        simple: ${AutoFocus.SamplesSearch.AFCookie}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1945
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "6":
    id: "6"
    taskid: b0d0c6b2-e838-4506-89e5-0450fcac37ff
    type: regular
    task:
      elasticcommonfields: {}
      id: b0d0c6b2-e838-4506-89e5-0450fcac37ff
      version: -1
      name: autofocus-sessions-search-results
      description: Get results of a previous sessions search
      script: AutoFocus V2|||autofocus-sessions-search-results
      type: regular
      iscommand: true
      brand: AutoFocus V2
    nexttasks:
      '#none#':
      - "8"
    scriptarguments:
      af_cookie:
        simple: ${AutoFocus.SessionsSearch.AFCookie}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1945
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "7":
    id: "7"
    taskid: c5b24e4c-5996-4e65-8b1a-7450737ce4a2
    type: condition
    task:
      elasticcommonfields: {}
      id: c5b24e4c-5996-4e65-8b1a-7450737ce4a2
      version: -1
      name: Verify context
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "10"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SamplesResults.Size
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SamplesResults.SHA1
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SamplesResults.SHA256
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SamplesResults.Created
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SamplesResults.Finished
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SamplesResults.Region
            iscontext: true
      - - operator: inList
          left:
            value:
              simple: AutoFocus.SamplesSearch.Status
            iscontext: true
          right:
            value:
              simple: in progress,complete
      - - operator: isExists
          left:
            value:
              complex:
                root: File
                accessor: Size
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: File
                accessor: SHA1
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: File
                accessor: SHA256
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: File
                accessor: Type
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: File
                accessor: Tags
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SamplesResults.Artifacts.b
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SamplesResults.Artifacts.g
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "8":
    id: "8"
    taskid: 29244780-aebf-4022-80c7-23adec4658fa
    type: condition
    task:
      elasticcommonfields: {}
      id: 29244780-aebf-4022-80c7-23adec4658fa
      version: -1
      name: Verify context
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "11"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SessionsResults.FileName
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SessionsResults.ID
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SessionsResults.Industry
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SessionsResults.Region
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SessionsResults.SHA256
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SessionsResults.Seen
            iscontext: true
      - - operator: inList
          left:
            value:
              simple: AutoFocus.SessionsSearch.Status
            iscontext: true
          right:
            value:
              simple: in progress,complete
      - - operator: isExists
          left:
            value:
              complex:
                root: File
                accessor: Name
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: File
                accessor: SHA256
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: File
                accessor: Tags
            iscontext: true
    view: |-
      {
        "position": {
          "x": 480,
          "y": 2120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "9":
    id: "9"
    taskid: 3ce49d8b-36b6-4e87-87d7-709db3f27248
    type: regular
    task:
      elasticcommonfields: {}
      id: 3ce49d8b-36b6-4e87-87d7-709db3f27248
      version: -1
      name: DeleteContext
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "39"
      - "29"
      - "26"
    scriptarguments:
      all:
        simple: "yes"
      index: {}
      key: {}
      keysToKeep: {}
      subplaybook: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "10":
    id: "10"
    taskid: 4b4ce9d5-f715-4cf9-8e78-70c015e91b97
    type: regular
    task:
      elasticcommonfields: {}
      id: 4b4ce9d5-f715-4cf9-8e78-70c015e91b97
      version: -1
      name: autofocus-sample-analysis
      description: |-
        Get properties, behaviors, and activities observed for a sample.
        Run the command once to get the fields and os's under HTTP,Coverage,Behavior,Registry,Files,Processes,Connections,DNS.
      script: AutoFocus V2|||autofocus-sample-analysis
      type: regular
      iscommand: true
      brand: AutoFocus V2
    nexttasks:
      '#none#':
      - "12"
    scriptarguments:
      coverage: {}
      filter_data: {}
      id: {}
      os: {}
      platforms: {}
      sample_id:
        simple: dd0d26ceea034b3ae32a4f6a477466ac598ee17f811f88cf14b2c708240fb993
      sections: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2295
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "11":
    id: "11"
    taskid: 36f60349-741e-44cf-846a-07aa58ff44a6
    type: regular
    task:
      elasticcommonfields: {}
      id: 36f60349-741e-44cf-846a-07aa58ff44a6
      version: -1
      name: autofocus-get-session-details
      description: Get session details by session ID
      script: AutoFocus V2|||autofocus-get-session-details
      type: regular
      iscommand: true
      brand: AutoFocus V2
    nexttasks:
      '#none#':
      - "14"
    scriptarguments:
      session_id:
        complex:
          root: AutoFocus
          accessor: SessionsResults.ID
          transformers:
          - operator: atIndex
            args:
              index:
                value:
                  simple: "0"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 2295
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "12":
    id: "12"
    taskid: 988e8ded-ae74-4d61-824c-63ce8f0a36ac
    type: condition
    task:
      elasticcommonfields: {}
      id: 988e8ded-ae74-4d61-824c-63ce8f0a36ac
      version: -1
      name: Verify context
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "15"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SampleAnalysis.Analysis.Coverage
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SampleAnalysis.Analysis.Behavior
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SampleAnalysis.Analysis.Registry
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SampleAnalysis.Analysis.Files
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SampleAnalysis.Analysis.Processes
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SampleAnalysis.Analysis.Mutex
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "14":
    id: "14"
    taskid: f2278cba-26f1-4a19-8e02-1def1ddef5ee
    type: condition
    task:
      elasticcommonfields: {}
      id: f2278cba-26f1-4a19-8e02-1def1ddef5ee
      version: -1
      name: Verify context
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "15"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.Sessions.FileName
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.Sessions.ID
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.Sessions.Industry
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.Sessions.Region
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.Sessions.SHA256
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.Sessions.Seen
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.Sessions.UploadSource
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: File
                accessor: Name
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: File
                accessor: SHA256
            iscontext: true
    view: |-
      {
        "position": {
          "x": 480,
          "y": 2470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "15":
    id: "15"
    taskid: da0bb36a-cecc-4844-8ede-07d596f3b1a6
    type: regular
    task:
      elasticcommonfields: {}
      id: da0bb36a-cecc-4844-8ede-07d596f3b1a6
      version: -1
      name: autofocus-top-tags-search
      description: Perform a search to Identify the most popular tags
      script: AutoFocus V2|||autofocus-top-tags-search
      type: regular
      iscommand: true
      brand: AutoFocus V2
    nexttasks:
      '#none#':
      - "18"
    scriptarguments:
      class:
        simple: Malicious Behavior
      commodity: {}
      private:
        simple: "True"
      public:
        simple: "True"
      scope:
        simple: all
      unit42: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2645
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "16":
    id: "16"
    taskid: 0a507b19-3f7f-4391-87e1-38d3ac744221
    type: regular
    task:
      elasticcommonfields: {}
      id: 0a507b19-3f7f-4391-87e1-38d3ac744221
      version: -1
      name: autofocus-top-tags-results
      description: Get the results of a previous top tags search
      script: AutoFocus V2|||autofocus-top-tags-results
      type: regular
      iscommand: true
      brand: AutoFocus V2
    nexttasks:
      '#none#':
      - "19"
    scriptarguments:
      af_cookie:
        simple: ${AutoFocus.TopTagsSearch.AFCookie}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 3170
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "17":
    id: "17"
    taskid: 4ec48395-3569-4975-832f-0df9460388fa
    type: regular
    task:
      elasticcommonfields: {}
      id: 4ec48395-3569-4975-832f-0df9460388fa
      version: -1
      name: autofocus-tag-details
      description: Get details on a given tag
      script: AutoFocus V2|||autofocus-tag-details
      type: regular
      iscommand: true
      brand: AutoFocus V2
    nexttasks:
      '#none#':
      - "20"
    scriptarguments:
      tag_name:
        complex:
          root: AutoFocus
          accessor: TopTagsResults.PublicTagName
          transformers:
          - operator: atIndex
            args:
              index:
                value:
                  simple: "0"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 3520
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "18":
    id: "18"
    taskid: 0ff0be33-ba66-4074-8330-1f5bcd6ed36d
    type: condition
    task:
      elasticcommonfields: {}
      id: 0ff0be33-ba66-4074-8330-1f5bcd6ed36d
      version: -1
      name: Verify context
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "24"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.TopTagsSearch.AFCookie
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.TopTagsSearch.Status
            iscontext: true
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2820
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "19":
    id: "19"
    taskid: da3342c0-ed45-4848-82c4-2f4b6c7ecad3
    type: condition
    task:
      elasticcommonfields: {}
      id: da3342c0-ed45-4848-82c4-2f4b6c7ecad3
      version: -1
      name: Verify context
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "17"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.TopTagsResults.Count
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.TopTagsResults.PublicTagName
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.TopTagsResults.TagName
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.TopTagsResults.Lasthit
            iscontext: true
    view: |-
      {
        "position": {
          "x": 265,
          "y": 3345
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "20":
    id: "20"
    taskid: 5cfff5ad-4c4c-4535-8852-9c4a6af19bcd
    type: condition
    task:
      elasticcommonfields: {}
      id: 5cfff5ad-4c4c-4535-8852-9c4a6af19bcd
      version: -1
      name: Verify context
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "21"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.Tag.TagName
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.Tag.PublicTagName
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.Tag.Count
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.Tag.Lasthit
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.Tag.TagDefinitionScope
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.Tag.CustomerName
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.Tag.Source
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.Tag.TagClass
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.Tag.TagDefinitionStatus
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.Tag.Description
            iscontext: true
    view: |-
      {
        "position": {
          "x": 265,
          "y": 3695
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "21":
    id: "21"
    taskid: 9b6e0dd4-645d-45ba-8e78-b39c74e5b59c
    type: title
    task:
      elasticcommonfields: {}
      id: 9b6e0dd4-645d-45ba-8e78-b39c74e5b59c
      version: -1
      name: DONE
      type: title
      iscommand: false
      brand: ""
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 3870
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "22":
    id: "22"
    taskid: 9279f899-69a0-49d1-80a6-a15a0f9111a5
    type: regular
    task:
      elasticcommonfields: {}
      id: 9279f899-69a0-49d1-80a6-a15a0f9111a5
      version: -1
      name: Sleep
      description: Sleep for X seconds
      scriptName: Sleep
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "5"
    scriptarguments:
      seconds:
        simple: "60"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "23":
    id: "23"
    taskid: 1f002d57-5998-4d56-8a80-84bef442ada2
    type: regular
    task:
      elasticcommonfields: {}
      id: 1f002d57-5998-4d56-8a80-84bef442ada2
      version: -1
      name: Sleep
      description: Sleep for X seconds
      scriptName: Sleep
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "6"
    scriptarguments:
      seconds:
        simple: "60"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "24":
    id: "24"
    taskid: af71d798-5df7-479d-8934-acc356cc80eb
    type: regular
    task:
      elasticcommonfields: {}
      id: af71d798-5df7-479d-8934-acc356cc80eb
      version: -1
      name: Sleep
      description: Sleep for X seconds
      scriptName: Sleep
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "16"
    scriptarguments:
      seconds:
        simple: "15"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2995
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "26":
    id: "26"
    taskid: 72a7d3dd-ae89-4de3-86d1-000274eff6b8
    type: regular
    task:
      elasticcommonfields: {}
      id: 72a7d3dd-ae89-4de3-86d1-000274eff6b8
      version: -1
      name: autofocus-search-samples
      description: Search for samples. To view results run the autofocus-samples-search-results
        command with the returned Af Cookie. The AF Cookie expires 120 seconds after
        the search completes.
      script: '|||autofocus-search-samples'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "33"
    scriptarguments:
      artifact: {}
      domain: {}
      file_hash:
        simple: 2e40edcf77d95173463ca4bfaf833a6a1860ffa4e7b03c3fded8de08ee2be27f
      first_seen:
        simple: 2016-01-12T00:00:00,2019-09-12T23:59:59
      ip: {}
      last_updated: {}
      max_results: {}
      order: {}
      query: {}
      scope:
        simple: Global
      sort: {}
      url: {}
      wildfire_verdict:
        simple: Malware
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "29":
    id: "29"
    taskid: e458a60b-1687-463e-8f4a-c0f64f51fdf1
    type: regular
    task:
      elasticcommonfields: {}
      id: e458a60b-1687-463e-8f4a-c0f64f51fdf1
      version: -1
      name: autofocus-search-sessions
      description: Search for sessions. To view results run the autofocus-sessions-search-results
        command with the returned AF Cookie. The AF Cookie expires 120 seconds after
        the search completes.
      script: '|||autofocus-search-sessions'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "34"
    scriptarguments:
      domain: {}
      file_hash: {}
      from_time:
        simple: 2019-07-09T23:00:00
      ip:
        simple: 23.62.60.187
      max_results: {}
      order: {}
      query: {}
      sort: {}
      to_time:
        simple: 2019-07-28T10:00:00
      url: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "30":
    id: "30"
    taskid: ad645014-16f1-4490-85e3-c78271cc98c9
    type: regular
    task:
      elasticcommonfields: {}
      id: ad645014-16f1-4490-85e3-c78271cc98c9
      version: -1
      name: Sleep
      description: Sleep for X seconds
      scriptName: Sleep
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "32"
    scriptarguments:
      seconds:
        simple: "60"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "31":
    id: "31"
    taskid: f1635554-fc8b-4507-852a-9df320908bf9
    type: regular
    task:
      elasticcommonfields: {}
      id: f1635554-fc8b-4507-852a-9df320908bf9
      version: -1
      name: Sleep
      description: Sleep for X seconds
      scriptName: Sleep
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "35"
    scriptarguments:
      seconds:
        simple: "60"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "32":
    id: "32"
    taskid: a96d5441-2777-49ae-82cb-cf09906b1746
    type: regular
    task:
      elasticcommonfields: {}
      id: a96d5441-2777-49ae-82cb-cf09906b1746
      version: -1
      name: autofocus-samples-search-results
      description: Returns results of a previous samples search.
      script: '|||autofocus-samples-search-results'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "37"
    scriptarguments:
      af_cookie:
        simple: ${AutoFocus.SamplesSearch.AFCookie}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 895
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "33":
    id: "33"
    taskid: d3aeed56-cd36-4a66-84db-4a4678b21d9e
    type: condition
    task:
      elasticcommonfields: {}
      id: d3aeed56-cd36-4a66-84db-4a4678b21d9e
      version: -1
      name: Verify context
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "30"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SamplesSearch.AFCookie
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SamplesSearch.Status
            iscontext: true
    view: |-
      {
        "position": {
          "x": 480,
          "y": 545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "34":
    id: "34"
    taskid: c093e374-d68c-41af-8e3b-9c06ff7be080
    type: condition
    task:
      elasticcommonfields: {}
      id: c093e374-d68c-41af-8e3b-9c06ff7be080
      version: -1
      name: Verify context
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "31"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SessionsSearch.AFCookie
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SessionsSearch.Status
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "35":
    id: "35"
    taskid: e788471d-5b2e-4cce-8c1a-e12560969fe7
    type: regular
    task:
      elasticcommonfields: {}
      id: e788471d-5b2e-4cce-8c1a-e12560969fe7
      version: -1
      name: autofocus-sessions-search-results
      description: Get results of a previous sessions search
      script: AutoFocus V2|||autofocus-sessions-search-results
      type: regular
      iscommand: true
      brand: AutoFocus V2
    nexttasks:
      '#none#':
      - "36"
    scriptarguments:
      af_cookie:
        simple: ${AutoFocus.SessionsSearch.AFCookie}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 895
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "36":
    id: "36"
    taskid: 90997f51-1fb8-425c-83a0-b094faf0bb8f
    type: condition
    task:
      elasticcommonfields: {}
      id: 90997f51-1fb8-425c-83a0-b094faf0bb8f
      version: -1
      name: Verify context
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "38"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SessionsResults.FileName
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SessionsResults.ID
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SessionsResults.Industry
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SessionsResults.Region
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SessionsResults.SHA256
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SessionsResults.Seen
            iscontext: true
      - - operator: inList
          left:
            value:
              simple: AutoFocus.SessionsSearch.Status
            iscontext: true
          right:
            value:
              simple: in progress,complete
      - - operator: isExists
          left:
            value:
              complex:
                root: File
                accessor: Name
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: File
                accessor: SHA256
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "37":
    id: "37"
    taskid: 179b2aa5-79f9-42dc-8463-e0322e240f35
    type: condition
    task:
      elasticcommonfields: {}
      id: 179b2aa5-79f9-42dc-8463-e0322e240f35
      version: -1
      name: Verify context
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "38"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SamplesResults.Size
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SamplesResults.SHA1
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SamplesResults.SHA256
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SamplesResults.Created
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SamplesResults.Finished
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SamplesResults.Region
            iscontext: true
      - - operator: inList
          left:
            value:
              simple: AutoFocus.SamplesSearch.Status
            iscontext: true
          right:
            value:
              simple: in progress,complete
      - - operator: isExists
          left:
            value:
              complex:
                root: File
                accessor: Size
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: File
                accessor: SHA1
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: File
                accessor: SHA256
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: File
                accessor: Type
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: File
                accessor: Tags
            iscontext: true
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "38":
    id: "38"
    taskid: c37b3e92-c009-4c6f-8c66-710432d0a755
    type: regular
    task:
      elasticcommonfields: {}
      id: c37b3e92-c009-4c6f-8c66-710432d0a755
      version: -1
      name: DeleteContext
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "2"
      - "1"
    scriptarguments:
      all:
        simple: "yes"
      index: {}
      key: {}
      keysToKeep: {}
      subplaybook: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1245
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "39":
    id: "39"
    taskid: c5d8e8b0-f7f6-452d-8f47-ecca45850ae3
    type: title
    task:
      elasticcommonfields: {}
      id: c5d8e8b0-f7f6-452d-8f47-ecca45850ae3
      version: -1
      name: Indicators Reputation
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "40"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -560,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "40":
    id: "40"
    taskid: 198903d1-29fd-4f73-88b7-a8067c8b0c59
    type: regular
    task:
      elasticcommonfields: {}
      id: 198903d1-29fd-4f73-88b7-a8067c8b0c59
      version: -1
      name: Check URL Reputation
      description: Checks the reputation of the url in Autofocus.
      script: AutoFocus V2|||url
      type: regular
      iscommand: true
      brand: AutoFocus V2
    nexttasks:
      '#none#':
      - "41"
    scriptarguments:
      long: {}
      retries: {}
      retry-count:
        simple: "5"
      sampleSize: {}
      submitWait: {}
      threshold: {}
      url:
        simple: www.andromedaa.ir/ir/andromedaa/likebegir/ap.smali/
      wait: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -560,
          "y": 545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "41":
    id: "41"
    taskid: bf773c46-5ef6-4f5b-8f40-ca50eefc1efa
    type: condition
    task:
      elasticcommonfields: {}
      id: bf773c46-5ef6-4f5b-8f40-ca50eefc1efa
      version: -1
      name: Validate URL Reputation
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "43"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: DBotScore.Indicator
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: URL.Data
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: AutoFocus.URL.IndicatorValue
            iscontext: true
    view: |-
      {
        "position": {
          "x": -560,
          "y": 720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "42":
    id: "42"
    taskid: d32dae5a-7093-409d-871a-6c6481686e57
    type: title
    task:
      elasticcommonfields: {}
      id: d32dae5a-7093-409d-871a-6c6481686e57
      version: -1
      name: done
      type: title
      iscommand: false
      brand: ""
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -560,
          "y": 1945
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "43":
    id: "43"
    taskid: b2f051f9-5329-4f0f-84a1-57a879ba137e
    type: regular
    task:
      elasticcommonfields: {}
      id: b2f051f9-5329-4f0f-84a1-57a879ba137e
      version: -1
      name: Check IP Reputation
      description: Checks the reputation of an IP address in Autofocus.
      script: AutoFocus V2|||ip
      type: regular
      iscommand: true
      brand: AutoFocus V2
    nexttasks:
      '#none#':
      - "44"
    scriptarguments:
      fullResponse: {}
      ip:
        simple: 8.8.8.8
      long: {}
      retries: {}
      retry-count:
        simple: "5"
      sampleSize: {}
      threshold: {}
      wait: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -560,
          "y": 895
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "44":
    id: "44"
    taskid: d6916a49-82bf-4546-8e9a-76387997c85f
    type: condition
    task:
      elasticcommonfields: {}
      id: d6916a49-82bf-4546-8e9a-76387997c85f
      version: -1
      name: Validate IP Reputation
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "45"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: DBotScore.Indicator
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: IP.Address
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: AutoFocus.IP.IndicatorValue
            iscontext: true
    view: |-
      {
        "position": {
          "x": -560,
          "y": 1070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "45":
    id: "45"
    taskid: 653649f8-2d0a-43a9-8c60-0afecce5620b
    type: regular
    task:
      elasticcommonfields: {}
      id: 653649f8-2d0a-43a9-8c60-0afecce5620b
      version: -1
      name: Check File Reputation
      description: Checks the reputation of a file in Autofocus.
      script: AutoFocus V2|||file
      type: regular
      iscommand: true
      brand: AutoFocus V2
    nexttasks:
      '#none#':
      - "46"
    scriptarguments:
      codeItemType: {}
      delay: {}
      file:
        simple: 9040e9fda52931c9472c90ecad5b74295cdb9cf7b68e2b89219700f6a8bff5ac
      long: {}
      maxRetries: {}
      md5: {}
      retries: {}
      retry-count:
        simple: "5"
      sha256: {}
      threshold: {}
      wait: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -560,
          "y": 1245
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "46":
    id: "46"
    taskid: e2a1dad0-a087-42de-897a-2c3c4d536e18
    type: condition
    task:
      elasticcommonfields: {}
      id: e2a1dad0-a087-42de-897a-2c3c4d536e18
      version: -1
      name: Validate File Reputation
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "47"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: DBotScore.Indicator
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: AutoFocus.File.IndicatorValue
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: File.SHA256
            iscontext: true
    view: |-
      {
        "position": {
          "x": -560,
          "y": 1420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "47":
    id: "47"
    taskid: 9e77b88d-422f-483f-800b-7b95fe400344
    type: regular
    task:
      elasticcommonfields: {}
      id: 9e77b88d-422f-483f-800b-7b95fe400344
      version: -1
      name: Check Domain Reputation
      description: Checks the reputation of a domain in Autofocus.
      script: AutoFocus V2|||domain
      type: regular
      iscommand: true
      brand: AutoFocus V2
    nexttasks:
      '#none#':
      - "48"
    scriptarguments:
      domain:
        simple: dropwellsfargo.com
      fullResponse: {}
      long: {}
      retries: {}
      retry-count:
        simple: "5"
      sampleSize: {}
      threshold: {}
      wait: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -560,
          "y": 1595
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "48":
    id: "48"
    taskid: 5e46fdce-b581-4bc3-8ab8-365e41100454
    type: condition
    task:
      elasticcommonfields: {}
      id: 5e46fdce-b581-4bc3-8ab8-365e41100454
      version: -1
      name: Validate Domain Reputation
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "42"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: DBotScore.Indicator
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Domain.Name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: AutoFocus.Domain.IndicatorValue
            iscontext: true
    view: |-
      {
        "position": {
          "x": -560,
          "y": 1770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 3885,
        "width": 1420,
        "x": -560,
        "y": 50
      }
    }
  }
inputs: []
outputs: []
